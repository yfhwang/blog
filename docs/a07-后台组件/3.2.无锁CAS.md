## 并发类型

### 加锁mutex

只唤醒一个线程

如果获取不到锁，让出CPU。去尝试获取锁并不耗时间，等拿到锁是比较耗时间的

![image-20210512213314901](../images/image-20210512213314901.png)

### 自旋锁

获取不到锁，继续检测。一次查询30ms，前两个连接消耗导致第三个连接空等30ms、60ms，空等CPU消耗时间

- 获取自旋锁

  如果不能及时获取，为忙等待，占CPU

- 执行任务（时间长度）

  1. 不能存在阻塞
  2. 任务耗时短，几条指令； count++; sum+=count;

- 释放自旋锁



### 无锁CAS(compare and swap)

比较并交换（compare and swap, CAS），是原子操作的一种，可用于在多线程编程中实现不被打断的数据交换操作，从而避免多线程同时改写某一数据时由于执行顺序不确定性以及中断的不可预知性产生的数据不ー致问题。该操作通过将内存中的值与指定数据进行比较，当数值一样时将内存中的数据替换为新的值。





























