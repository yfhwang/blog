## 主键盘快捷键

### 光标移动

1. 向上↑： ctrl+p (previous)
2. 向下↓： ctrl+n (next)
3. 向左←：ctrl+b (backward)
4. 右→：ctrl+f (forward)
5. 移动到头部: ctrl + a
6. 移动到尾部: ctrl + e

### 删除字符

1. 删除光标后边的: ctrl + d
	
2. 删除光标前边的: ctrl + h
3. 删除光标前的所有内容：ctrl + u

清屏：ctrl+L

## Linux目录结构

![Image](../images/Image.jpg)

- **/bin**

  bin是Binary的缩写, 这个目录存放着**最经常使用的命令**。

- /boot

  这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。

- **/dev**

  dev是Device(设备)的缩写, 该目录下存放的是Linux的**外部设备**，在Linux中访问设备的方式和访问文件的方式是相同的。

- **/etc**

  这个目录用来存放所有的系统管理所需要的**配置文件**和子目录。

- **/home**

  用户的主目录，在Linux中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。

- **/lib**

  这个目录里存放着系统最基本的**动态连接共享库**，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。

- /lost+found

  这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。

- **/media**   

  linux系统会**自动识别一些设备**，例如U盘、光驱等等，当识别后，linux会把识别的设备挂载到这个目录下。

- **/mnt**

  系统提供该目录是为了让用户**临时挂载**别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。

- /opt

   这是给主机**额外安装软件**所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。

- /proc

  这个目录是一个虚拟的目录，它是**系统内存的映射**，我们可以通过直接访问这个目录来获取系统信息。
  这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的ping命令，使别人无法ping你的机器：

  `echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_all`

- /root

  该目录为系统管理员，也称作超级权限者的用户主目录

- /sbin

  s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序。

- /selinux

  这个目录是Redhat/CentOS所特有的目录，Selinux是一个安全机制，类似于windows的防火墙，但是这套机制比较复杂，这个目录就是存放selinux相关的文件的。

- /srv
   该目录存放一些服务启动之后需要提取的数据。

- /sys
   这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。该文件系统是内核设备树的一个直观反映。当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统种被创建。

- /tmp

  这个目录是用来存放一些临时文件的。

- **/usr**

   这是一个非常重要的目录，**用户的很多应用程序和文件**都放在这个目录下，类似与windows下的program files目录。

   - /usr/bin

      系统用户使用的应用程序。

   - /usr/sbin

     超级用户使用的比较高级的管理程序和系统守护程序。

   - /usr/src

      内核源代码默认的放置目录。

- /var

  这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种**日志文件**

> **在linux系统中，有几个目录是比较重要的，平时需要注意不要误删除或者随意更改内部文件。**
>
> /etc： 上边也提到了，这个是系统中的配置文件，如果你更改了该目录下的某个文件可能会导致系统不能启动。
>
> /bin, /sbin, /usr/bin, /usr/sbin: 这是系统预设的执行文件的放置目录，比如 ls 就是在/bin/ls 目录下的。
>
> 值得提出的是，/bin, /usr/bin 是给系统用户使用的指令（除root外的通用户），而/sbin, /usr/sbin 则是给root使用的指令。
>
> /var： 这是一个非常重要的目录，系统上跑了很多程序，那么每个程序都会有相应的日志产生，而这些日志就被记录到这个目录下，具体在/var/log 目录下，另外mail的预设放置也是在这里。

## 文件和目录操作

```sh
cd - #在临近的两个目录直接切换
tree 目录  #显示文件夹树结构
```

### 文件或目录颜色

<img src="../images/image-20210121162502211.png" alt="image-20210121162502211" style="zoom: 50%;" />

### 文件权限

![](../images/1_ls.png)

r-read w-write x-execute

### 文件操作

删除：rm -ri 删除时会提示

创建：touch xx 文件不存在：创建文件；文件存在：修改文件时间

拷贝：cp mytest/ newDir 拷贝文件夹。若newDir存在，则放入；若不存在，则创建

查看文件 cat more(只能向下浏览) less(可以上下浏览) head tail

### 链接 ln

#### 软连接（符号链接）

相当于windows下快捷方式

- 创建软链接，源文件要使用**绝对路径**
- 软连接大小：源文件+路径 的总字节数
- 目录可以创建软链接

```sh
ln -s /home/a.txt（源文件名+绝对路径） a.test（软链接的名字）
```

#### 硬链接

注意事项

- 以**文件副本**的形式存在。但**不占用实际空间**
- 不允许给目录创建硬链接
- 硬链接只有在同一个文件系统中才能创建

硬链接能够**同步更新**

- linux下每一个文件都对应一个Inode，创建硬链接后，两个文件的Inode是相同的
- 查看文件的Inode：`stat a.txt`
- 文件创建硬链接后，硬链接计数+1，删除一个硬链接，硬链接计数-1

> inode：i节点，保存了一些文件信息，通过inode找到对应的节点·	

### 文件或目录属性

`wc a.txt`		查看文件的行数  字数  字节数  文件名

`od`	查看二进制文件信息

`du`(disk use)   查看某个目录的大小 

`df`(disk free)   查看磁盘的使用情况  一般加参数 `-h`（human） 以人类能看懂的方式显示 

`which`    查看指定命令所在的路径

> which指令会在PATH变量指定的路径中，搜索某个系统命令的位置，并且返回第一个搜索结果。

## 权限

### whoami

查看当前登录用户

### chmod

> (change mod)

#### 文字设定法

`chmod [who] [+|-|=] [mode] 文件名`

- 操作对象【who】
  - u -- 用户（user）
  - g -- 同组用户（group）
  - o -- 其他用户（other）
  - a -- 所用用户（all）【默认】		
- 操作符【+-=】
     - \+ 添加权限
     - \-  取消权限
     - = 赋予给定权限并取消其他权限l
   - 权限【mode】
     		r -- 读
       		w -- 写
       		x -- 执行
     例：chmod u+wx file.txt

#### 数字设定法.

`chmod 777 file.txt`

- 数字表示的含义
  - 0 -- 没有权限(-)
  - 1 -- 执行权限（x）
  - 2 -- 写权限（w）
  - 4 -- 读权限（r)
- 操作符【+-=】

### chown

将指定文件的拥有者改为指定的用户或组 -- change owner

- chown + 文件所属用户 + 文件或目录名

​			`sudo chown nobody text.txt`

- chown + 文件所属用户：文件所属组 + 文件或目录名

​			`sudo chown nobody：nogroup text.txt`

### chgrp

改变文件或目录的所属群组

- chgrp + 用户组 + 文件或目录名

​		`sudo chgrp nogroup text.txt`

## 查找和检索

### find

- 按文件名查询：`-name`

  - find + 路径 + -name + 文件名
  - eg `find /home -name a.txt`

- 按文件大小查询：`-size`

  - find + 路径 + -size + 范围
    - 范围
      - 大于：+100k
      - 小于：-100k
      - 等于： 100k
    - 大小
      - M 必须大写
      - k 必须小写

  - 例子
    - 等于100k的文件: `find ~/ -size 100k`
    - 大于100k的文件: `find ~/ -size +100k`
    - 大于50k, 小于100k的文件: `find ~/ -size +50k -size -100k`

### grep

- 按文件内容查找
  - grep -r + “查找的关键字” + 路径
  - eg: `grep -r "main void" /home/itcast`

## 软件安装和卸载

### 在线安装

- apt-get

  - 安装：`sudo apt-get install tree` -- 在线下载安装

  - 移除：`sudo apt-get remove tree`

  - 更新：`sudo apt-get update` -- 更新软件列表

  - 清理所有软件安装包: `sudo apt-get clean`

    > 实际清理的是: /var/cache/apt/archives 目录下的 .deb 文件

- aptitude
  - 安装：`sudo aptitude install tree`
  - 重新安装：`sudo aptitude reinstall tree`
  - 更新：`sudo apt-get update`
  - 移除：`sudo aptitude remove tree`
  - 显示状态：`sudo aptitude show tree`

### deb包安装

- 安装 `sudo dpkg -i xxx.deb`

  > i--install    r--remove

- 删除 `sudo dpkg -r xxx`

### 源码安装

1. 解压缩源代码包
2. 进入到安装目录：cd dir
3. 检测文件是否缺失，创建Makefile，检测编译环境： ./configure
4. 编译源码，生成库和可执行程序：make
5. 把库和可执行程序，安装到系统目录下：sudo make install
6. 删除和卸载软件：sudo make distclean
7. 上述安装步骤并不是绝对的，应该先查看附带的 README 文件

### apt-get下载过慢

- https://blog.csdn.net/weixin_46474546/article/details/104708220
- https://www.cnblogs.com/zhaogaojian/p/12888227.html

1. 重命名原来的源作为备份：

```sh
sudo mv /etc/apt/sources.list /etc/apt/sources.list.backup
```

2. 新建一个sources.list文件

```sh
sudo gedit /etc/apt/sources.list
```

3. 复制以下内容并保存（阿里云源）：

```
deb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe
deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-properties
deb http://archive.canonical.com/ubuntu xenial partner
deb-src http://archive.canonical.com/ubuntu xenial partner
deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse
```

4. 更新apt软件源：

```sh
sudo apt-get update
```

## 磁盘管理

### mount

- 系统默认挂载目录：/media
- 手动挂载目录：/mnt
- 挂载方式：mount + 设备名 + 挂载目录
  - 设备名
    - 检测设备名称： sudo fdisk -l
    - 磁盘命名规则
  - 挂载目录
    - 默认手动挂载到　/mnt
    - **注意**：挂载到/mnt以外的目录：挂载成功后会遮蔽掉目录中原来的东西，卸载设备之后才能看到目录中原来的数据

### unmount

sudo umount /mnt

**注意**：卸载的时候，用户的当前位置一定不能再 /mnt（/media）或者其子目录下，否则无法卸载

### 磁盘命名规则

![image-20210121202703269](../images/image-20210121202703269.png)

## 压缩包管理

### 打包 tar

`tar` 命令只打包不压缩，通过参数来完成压缩和解压

#### 参数

- z -> 用 gzip 来压缩/解压缩文件
  j -> 用 bzip2 来压缩/解压缩文件

- c -> create，创建新的压缩文件。如果用户想备份一个目录或是一些文件，就要选择这个选项。
  x -> 从压缩文件中释放文件

- v -> 详细报告tar处理的文件信息
- f -> 指定压缩文件的名字

#### 压缩

- tar + 参数（zcvf） + 压缩包名字.tar.gz + 原材料（要打包压缩的文件或目录）
- tar + 参数（jcvf） + 压缩包名字.tar.bz2 + 原材料（要打包压缩的文件或目录）

#### 解压缩

- tar + 参数（zxvf） + 已有的压缩包（test.tar.gz）
- tar + 参数（jxvf） + 已有的压缩包（test.tar.bz2）
- 指定解压目录：添加参数 -C（大写）
  tar zxvf test.tar.gz -C + 解压目录（./mytest）

### 压缩

`命令 [参数] 压缩文件名 压缩的文件和目录`

#### .gz 格式

压缩：gzip 命令

解压缩：gunzip 命令

- 压缩过程中不保留源文件
- **不能对目录**进行压缩
- **不能对多个文件**进行打包压缩

#### .bz2格式

压缩：bzip2 命令

解压缩：bunzip2 命令

- 通过使用参数 -k(keep) 保留源文件
- **不能对目录**进行压缩
- **不能对多个文件**进行打包压缩

#### rar

使用前需要安装 rar 工具 sudo apt-get install rar

`rar <命令> -<选项1> ….-<选项N> <操作文档> <文件…> <@文件列表…> <解压路径>`

- 命令
  - a -> 添加文件到操作文档
  - x -> 带路径解压文档中内容到当前目录
- 选项
  
- r -> 递归子目录
  
- 打包 `rar a -r + 压缩文件名（newdir） + 压缩的目录（./mydir）`

  打包的生成的新文件不需要指定后缀		

- 解包 `rar x all.rar + 目录（/home/itcast/test）`

## 进程管理（直观理解）

### who

查看当前在线用户的情况：登录的用户名、使用的设备终端（pts）、登录到系统的时间

```sh
ivan@ubuntu:~$ who
ivan     tty7         2021-01-20 08:36 (:0)
ivan     pts/5        2021-01-22 04:09 (192.168.170.1)
```

tty 设备：图形和文字界面互不影响

- tty1 - tty6 表示文字界面：ctrl + alt + [F1-F6]
- tty7 图形界面：ctrl +　alt + F7

### ps

查看整个系统内部所运行的进程状况

- 涉及的参数
  - a：（all）当前系统所有用户的进程
  - u：查看进程所有者及其他一些信息
  - x：显示没有控制终端的进程 -- 不能与用户进行交互的进程【输入、输出】	
- 显示当前用户下所有进程 ps aux
- 对显示的进程过滤 `ps aux | grep xxx`
  - 什么是管道（|）<img src="../images/image-20210122203421789.png" alt="image-20210122203421789" style="zoom:33%;" />
    			
    - 指令1的输出作为指令2的输入
    - 指令2处理完毕，将信息输出到屏幕
  - grep查询是需要占用一个进程的，所有结果 > 2 才能说明查询结果存在
  - 如果结果有一条，表示没有查询的进程
  - 查询结果中PID表示进程ID

### kill

用来终止指定的进程（terminate a process）的运行

 `kill -9 【PID-进程标识号】`

向当前进程发送了9号信号（SIGKILL）

### env

查看当前进程环境变量

- 当前系统下用户的配置路径信息
- 格式为键值对：key=value:value  （多个值之间用:分隔）
- PATH：该环境变量中记录着shell命令解析器去查找命令的目录位置，从前往后的顺序查找

### top

相当于windows下的任务管理器，文字版，不能翻页

## 网络管理

### ifconfig

获取网络接口配置信息，修改这些配置

![image-20210122214038828](../images/image-20210122214038828.png)

### ping

测试与目标主机的连通性

 `ping [参数] [主机名或IP地址]`

- 参数
  - -c 数目：在发送指定数目的包后停止。
  - -i 秒数：设定间隔几秒送一个网络封包给一台机器，预设值是一秒送一次

### nslookup

查看服务器域名对应的IP地址

一般访问网站都是使用域名，如：www.baidu.com，使用该命令就可查看百度所有服务器的IP地址

## 用户管理

### 创建用户

- `sudo adduser + 用户名（luffy）`
- 参数
  - -s 指定新用户登陆时shell类型
  - -g 指定所属组，该组必须已经存在
  - -d 用户家目录
  - -m 用户家目录不存在时，自动创建该目录
- eg: `sudo useradd -s /bin/bash -g itcast -d /home/itcast -m itcast`

### 设置用户组

```sh
sudo groupadd itcast
```

### 删除用户

```sh
sudo deluser + 用户名（luffy）
sudo userdel -r itcast
选项 -r 的作用是把用户的主目录一起删除
```

### 设置密码

```sh
sudo passwd + 用户名（luffy）
```

### 退出登录用户

exit

## FTP服务器

ftp服务器作用: 文件的上传和下载

### 安装

```sh
sudo apt-get install vsftpd# 客户端服务器都会被安装
```


服务安装完毕之后，ftp服务会随开机自动启动

```
1>. 服务器端:
		1). 修改配置文件 - 如何修改配置文件 -- /etc/vsftpd.conf
		2). 重启服务 -- 什么命令能够重启服务
2>. 客户端:
		1). 实名用户登录
					ftp + IP(server)
					输入用户名(server)
					输入密码
					
					文件的上传和下载
							文件的上传: put file
							文件的下载: get file
							不允许操作目录, 如果想操作目录 -- 打包 tar/rar/zip
		2). 匿名用户登录
					ftp + serverIP
					用户名: anonymous
					密码: 直接回车
					
					不允许匿名用户在任意目录直接切换
					只能在一个指定的目录范围内工作
					需要再ftp服务器上创建一个匿名用户的目录 -- 匿名用户的根目录
					
					
		3). lftp客户端访问ftp服务器
```

### 配置

- 服务器进行配置，配置给客户端使用
- 修改配置文件：gedit /etc/vsftpd.conf
  - write_enable=YES -> 是否拥有写权限	
  - anon_root=/home/itcast/ftp -> 匿名用户ftp根目录
  - anonymous_enable=YES -> 是否允许使用匿名用户
  - anon_upload_enable=YES -> 是否允许匿名用户上传权限
  - anon_mkdir_write_enable=YES -> 是否允许匿名用户创建目录

![vsftpd.conf](../images/vsftpd.conf.png)

### 启动

配置完成之后，必须重启服务器新的配置才能够生效

```bash
sudo /lib/init/upstart-job vsftpd restart -- 14.04版本

sudo service vsftpd restart -- 通用，与版本无关
```

### 实名用户

- 连接服务器：ftp + 服务器IP（192.168.1.100）

- 用户可以访问服务器的任意目录
- 文件的上传和下载
  - 上传：put xxx
  - 下载：get xxx
  - 不能够上传下载目录，如有需求可以制作压缩包
- 退出  quit  bye  exit

### 匿名用户

- 连接服务器：ftp + 服务器IP（192.168.1.100）
  Name：anonymous      Password: 

- 指定匿名用户登录的根目录

  - 配置文件中添加：anon_root=/home/itcast/ftp

    或使用默认位置：/srv/ftp 
    可搜索/etc/passwd 文件中的ftp，里边给出了默认路径 /srv/ftp

  - 在指定的ftp目录下创建一个供匿名用户上传下载的目录

    - `sudo mkdir /srv/ftp/anonPersion`

    - `sudo chown ftp:nogroup /srv/ftp/annoPersion`
      把目录的所用者指定为ftp用户，设置组为nogroup(不属于任何组)

      或 `chmod 777 anonPersion`
      

### lftp

一个ftp客户端工具， 可以上传和下载目录

`sudo apt-get install lftp`

- 匿名

```
lftp 服务器IP
login
```

- 实名

```
lftp username@127.0.0.1 回车
输入服务器密码
```

| 命令      | 操作                   |
| --------- | ---------------------- |
| put       | 上传文件               |
| mput      | 上传多个文件           |
| get       | 下载文件               |
| mget      | 下载多个文件           |
| mirror    | 下载整个目录及其子目录 |
| mirror –R | 上传整个目录及其子目录 |

## nfs共享服务器

net file system 网络文件系统，它允许网络中的计算机之间通过TCP/IP网络共享资源。

### 服务端

- 安装：sudo apt-get install nfs-kernel-server

- 创建一个欲共享出去的目录
  如：/home/xxx/xxx（/home/itcast/itcast）

- 打开配置文件：sudo vi /etc/exports
- 写入共享目录的绝对路径，及对应权限。
  如：/home/itcast/itcast *（ro,sync,no_root_squash）
  - ro -> 只读权限
  - rw -> 读写权限
  - sync -> 资料同步写入到内存与硬盘当中 
  - async -> 资料会先暂存于内存当中，而非直接写入硬盘 
  - no_root_squash -> 登入NFS主机，使用该共享目录时相当于该目录的拥有者，
    如果是root的话，那么对于这个共享的目录来说，他就具有root的权 限，这个数『极不安全』，不建议使用
  - root_squash -> 登入NFS主机，使用该共享目录时相当于该目录的拥有者。但是如果是以root身份使用这个共享目录的时候，那么这个使用者（root）的权限将被压缩成为匿名使用者，即通常他的UID与GID都会变成nobody那个身份
  - all_squash -> 不论登入NFS的使用者身份为何，他的身份都会被压缩成为匿名使用者，通常也就是nobody
  - 其中 * 代表一个IP地址段，如：192.168.10.* （有的版本这样写有问题，目录无法共享出去）

- 重启nfs：

  ```sh
  sudo /etc/init.d/nfs-kernel-server restart
  sudo service nfs-kernel-server restart
  ```

### 客户端

客户端访问共享目录：mount + IP:共享目录名 挂载目录

`sudo mount 192.168.32.75:/home/itcast/itcast/ /mnt`

cd 到本机的/mnt 目录中就可以使用cp命令得到目录中的所有文件。

## SSH服务器

### 安装ssh

sudo atp-get install openssh-server

查看SSH是否安装

sudo aptitude show openssh-server

### 远程登录

ssh 用户名@IP
	确认连接的时候一定要写yes/no

例如：服务器管理员通过ssh远程登录外地主机，进行维护

### 退出登录

​	logout

## scp命令

scp == super copy

使用该命令的前提条件：目标主机已经成功安装openssh-server

```sh
scp -r 目标用户名@IP地址:/目标文件的绝对路径 /保存到本机的绝对（相对）路径
		在后续会提示输入“yes”此时，只能输“yes”而不能简单输入“Y”

scp -r itcast@192.168.1.100:/home/itcast/QQ_dir/ ./mytest/360
	拷贝目录需要加参数 -r
```

## 关机重启

poweroff   reboot   shutdown

```
shutdown
		参数
			-t 秒数 : 设定在切换至不同的runlevel之前, 警告和删除二讯号之间的延迟时间(秒).
			-k : 仅送出警告讯息文字, 但不是真的要 shutdown.
			-r : shutdown 之後重新开机.
			-h : shutdown 之後关机.
			-n : 不经过 init , 由 shutdown 指令本身来做关机动作.(不建议你用)
			-f : 重新开机时, 跳过 fsck 指令, 不检查档案系统.
			-F : 重新开机时, 强迫做 fsck 检查.
			-c : 将已经正在 shutdown 的动作取消.
		例子:
			shutdown -r now 立刻重新开机
			shutdown -h now 立刻关机
			shutdown -k now 'Hey! Go away! now....' 发出警告讯息, 但没有真的关机
			shutdown -t3 -r now 立刻重新开机, 但在警告和删除processes 之间, 延迟3秒钟.
			shutdown -h 10:42 'Hey! Go away!' 10:42 分关机
			shutdown -r 10 'Hey! Go away!' 10 分钟後关机
			shutdown -c 将刚才下的 shutdown 指令取消,必须切换至其它tty, 登入之後, 才能下此一指令.
			shutdown now 切换至单人操作模式(不加任何选项时)
```

